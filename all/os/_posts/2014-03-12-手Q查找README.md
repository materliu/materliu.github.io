---
layout: post
title: 手Q查找README.md
---
### 打开readme文件的同学，如果本机没有安装markdown相关的查看编辑器可以选用在线版： https://stackedit.io/
# QQ FIND mobile

接口人： materliu,csonlai

## Documentation

### relational link
[前台wiki][1]

[CGI Wiki][2]

[Moniter 视图][3]

[performance 视图][4]

[mm上报系统视图][5]

[伯努利上报系统视图][6]

[dc上报系统视图][10]

[本地构建工具grunt学习][7]

[图片压缩服务][8]

### 快速上手

#### 项目说明

手Q查找使用了grunt这一自动构建工具， CSS使用Sass和Compass来进行组织。目录结构如下：


如图所示:

* doc目录下存放所有的规范类文档；
* dist目录是grunt生成的处理后的代码目录，不需要主动编辑；
* test是自动化测试目录，现在尚未加入，预留功能；
* node_modules目录是grunt等相关编译工具存放目录；所有的逻辑代码存放于app目录。

根目录下的几个文件：

* .jshintrc  jshint 代码检测的配置文件
* bower.json bower 的配置文件， 暂时未用到(2014/02/26)
* config.json 我们自己的发布系统的配置文件， 在其中规定哪个文件发布到哪里
* config.rb  compass 的配置文件
* Gruntfile.js grunt 的配置文件
* p          我们在测试环境上部署代码需要的脚本文件
* package.json 整个项目其实相当于一个大的nodejs项目，package.json规定了这个nodjs项目用到的所有node_modules
* README.md  项目的说明文件， 就是你当前正在读的这个文件

#### 本地环境搭建
* sass和compass  sass和compass依赖于ruby环境，需要安装ruby运行时，windows平台下推荐： [RubyInstaller][9], 之后再命令行中 执行 gem install sass，gem install compass 安装sass和compass，  当然公司内网有时候需要加上  gem install sass --http-proxy=https://proxy.tencent.com:8080 你懂的
* grunt 需要本地有nodejs环境， 这个不用多说了， 在命令行执行： npm install -g grunt-cli  进行安装

#### 跑起来
* 本地访问方法1： 在命令行中执行 grunt server， 本机就会起一个服务器，部署当前查找项目，修改host，把find.qq.com 指向 127.0.0.1， 直接在浏览器中访问find.qq.com/index.html 即可
* 本地访问方法2： 直接使用fiddler代理，将find.qq.com/m/ 的请求指向本地项目目录。
* 部署测试环境访问： 在命令行中执行 grunt 完成代码发布前的编译工作，提交svn， 登陆测试环境机器，登陆方法：我们现有5台测试机器
    10.12.23.156
    10.12.23.157
    10.12.23.158
    10.12.23.159
    10.12.23.163
端口号使用 36000 账号是root  密码是： pass4devnet
登陆上去以后，进入 /data/frontend/qqfind_mobile ,将当前项目checkout下来， 进入项目目录， 在项目目录下执行编译部署脚本p
    chmod 777 p
    ./p 0|1|2|3|4   后边的参数分别对应机器 156,157,158,159,163，比如像部署到 156机器，执行./p 0

#### 发布流程

#####先ARS预编译：
http://pub.qplus.oa.com/html/ars_precompile.php
svn： 贴入当前要发布的tag的svn地址， 记得是https开头的
发布域名选择 QQ查找 find.qq.com
cdn发布路径选择  qqfind
编译说明： 此次发布的原因

得到类似地址：
<pre>
/data/sites/cdn.qplus.com/qqfind/m/js/find.*.js
/data/sites/cdn.qplus.com/qqfind/m/index.html
</pre>


[1]: http://tapd.oa.com/v3/Qplus/wikis/view/qq_mobile_find_env "web wiki"
[2]: http://tapd.oa.com/v3/QQchazhao/wikis/view/%2525E6%25259F%2525A5%2525E6%252589%2525BE%2525E6%252589%25258BQ%2525E7%25259B%2525B8%2525E5%252585%2525B3CGI "cgi wiki"
[3]: http://monitor.server.com/link/graph/viewid:6430 "monitor view"
[4]: http://m.isd.com/app/endusermonitor2/config/pointView.php?PHPSESSID=4eod1h9ai6nj910u3ek93sj7k6#date=2014-02-25&curTab=speed&productId=44101&serviceId=44101015&moduleId=388281&countryId=1&PHPSESSID=4eod1h9ai6nj910u3ek93sj7k6&flag1=7832&flag2=17&flag3=2 "performance view"
[5]: http://mm.isd.com/wns/wnsUsm.php#{"api":"wns_Usm.dDetailDimension","type":"table","data":{"date":"20140226","additional":{"appid":"1000154"},"groupby":"commandid"}}  "mm view"
[6]: http://webpc.oa.com/qqconnect/?ticket=778E4D57C8651EF31C9B87EF78C9B5E98E1E211C287CAFE18A8C402C5FFE4961AC618BDCC843138044B7A03FB6E50A4509D1C7A3EC33253CA8B424EF034A6555236C84962E065B7416DFF077662D7AE77A71FC9F286943C0150909966B5099D5E2D35AFC2103BAA91C1F91946B650E2280EC4BEAE5643DE0C40CD4C5D14937D8F631608651A95540718286DFB26FC2473AA22D1CD37B3D875214F91FC1CE1E5D3793DAD9C954611D5BBE4CA81CE402F05047C5CDF3C2DAD1B2E7BBAFBE6CBF1C&loginParam=disposed&length=35&lengh=35&sessionKey=778E4D57C8651EF31C9B87EF78C9B5E98E1E211C287CAFE18A8C402C5FFE4961AC618BDCC84313803A545E8300C3BABE  "伯努利 view"
[7]: http://gruntjs.com/ "grunt Official website"
[8]: http://www.smushit.com/
[9]: http://rubyinstaller.org/ "rubyinstall website"
[10]: http://oz.isd.com/index.php?menuId=15230&auth_cm_com_ticket=f3970759-e615-49bd-b253-0b464d911001
